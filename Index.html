<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Fases 1 y 2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <style>
        body { background-color: #f4f6f9; }
        .container { max-width: 1400px; margin-top: 20px; }
        .header-custom { background-color: #0a2e36; color: white; }
        .table-hover tbody tr:hover { background-color: #e9ecef; }
        
        /* Checkboxes m√°s grandes */
        .status-check { transform: scale(1.3); cursor: pointer; }
        
        /* Botones de archivo */
        .btn-file { border-radius: 50%; width: 30px; height: 30px; padding: 0; display: inline-flex; align-items: center; justify-content: center; border: 1px solid #ccc; }
        .has-file { background-color: #0d6efd; color: white; border-color: #0d6efd; }
        .btn-file:hover { background-color: #e2e6ea; }
        .has-file:hover { background-color: #0b5ed7; color: white; }

        /* Columnas compuestas */
        .col-fase { background-color: #f8f9fa; border-left: 1px solid #dee2e6; border-right: 1px solid #dee2e6; }
        
        /* Preview en Modal */
        #previewContainer { min-height: 200px; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; margin-top: 15px; border-radius: 8px; background: #fff; }
        #previewImage { max-width: 100%; max-height: 400px; display: none; }
        #previewPDF { width: 100%; height: 400px; display: none; border: none; }

        @media print {
            .no-print { display: none !important; }
            .btn-file { display: none; }
            /* Mostrar si hay archivo en texto al imprimir */
            .file-indicator::after { content: attr(data-status); font-size: 9px; color: #555; display: block; }
        }
    </style>
</head>
<body>

<div class="container mb-5">
    <h3 class="text-center mb-3">Control de Entregas: Tabla y Resumen</h3>
    
    <div class="card shadow-sm">
        <div class="card-header header-custom d-flex justify-content-between align-items-center">
            <span class="fw-bold"><i class="bi bi-journal-check"></i> Grupo Yu-Gi-Oh!</span>
            <input type="date" id="fechaInput" class="form-control form-control-sm" style="width: 140px;">
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0 text-center align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th width="3%">#</th>
                            <th width="8%">Matr√≠cula</th>
                            <th class="text-start" width="20%">Alumno</th>
                            <th width="5%">Asist</th>
                            
                            <th width="12%" class="bg-secondary text-white border-end">
                                Fase 1: Tabla
                            </th>
                            
                            <th width="12%" class="bg-secondary text-white border-end">
                                Fase 2: Resumen
                            </th>

                            <th width="30%">Dudas / Notas</th>
                        </tr>
                    </thead>
                    <tbody id="tablaCuerpo"></tbody>
                </table>
            </div>
        </div>

        <div class="card-footer d-flex justify-content-end gap-2 no-print">
            <button class="btn btn-danger btn-sm" onclick="borrarTodo()">‚ö†Ô∏è Reset DB</button>
            <button class="btn btn-secondary btn-sm" onclick="imprimirPDF()">üñ®Ô∏è PDF</button>
            <button class="btn btn-success btn-sm" onclick="generarJSON()">üíæ JSON</button>
        </div>
    </div>

    <div id="jsonContainer" class="card mt-3 shadow-sm no-print" style="display:none;">
        <div class="card-body p-2">
            <textarea id="jsonOutputText" class="form-control form-control-sm" rows="5" readonly></textarea>
        </div>
    </div>
</div>

<div class="modal fade" id="archivoModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-light">
                <h5 class="modal-title" id="modalTitulo">Gestionar Archivo</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info py-2" id="modalInfoAlumno"></div>
                
                <div class="input-group mb-3">
                    <input type="file" class="form-control" id="inputFile" accept="image/*,application/pdf">
                    <button class="btn btn-outline-danger" type="button" onclick="eliminarArchivoActual()">üóëÔ∏è Quitar</button>
                </div>

                <div id="previewContainer">
                    <span class="preview-placeholder text-muted">Sin archivo seleccionado</span>
                    <img id="previewImage" src="" alt="Preview">
                    <iframe id="previewPDF" src=""></iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="script.js"></script>

</body>
</html>